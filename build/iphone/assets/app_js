function createBannerAdView(e){var t,i,r;switch(e){case 1:t="284930",i="7bb422477552bc39eb05b0bd1f6fe88e71edb13b",r="ca-app-pub-8392863952863215/5895724484";break;case 2:t="287241",i="204bfde6ecc0ba1e66a0d551b2acd148eb6e648a",r="ca-app-pub-8392863952863215/7372457680";break;case 3:t="287242",i="f4ce7c6f230f5c31d518882fcd1e44caf93cb73f",r="ca-app-pub-8392863952863215/8849190889";break;default:t="",i="",r=""}var a=Math.floor(2*Math.random());switch(a){case 0:var n=Admob.createView({width:320,height:50,adUnitId:r,adBackgroundColor:"white"});break;case 1:var n=nend.createView({width:320,height:50,spotId:t,apiKey:i});break;default:var n=null}if(320!=Ti.Platform.displayCaps.platformWidth){var o=Ti.UI.create2DMatrix();o=o.scale(Ti.Platform.displayCaps.platformWidth/320),n.transform=o}return n}function createActInd(){var e=Titanium.UI.createActivityIndicator({height:"100%",width:"100%",font:{fontSize:16},color:"white",backgroundColor:"black",opacity:.3,style:"iPhone OS"===Ti.Platform.name?Ti.UI.iPhone.ActivityIndicatorStyle.BIG:Ti.UI.ActivityIndicatorStyle.BIG});return e}function checkLogin(){var e={uid:iOSUniqueID.getUUID,version:Ti.App.version},t=Ti.App.domain+"check_user.json";sendData(t,e,function(e){if(e.success)if(obj=e.data,"development"==obj.version){alert("ステージング環境"),Ti.App.domain="https://monstbbs-stg.herokuapp.com/";var t={uid:iOSUniqueID.getUUID,version:Ti.App.version},i=Ti.App.domain+"check_user.json";sendData(i,t,function(e){if(e.success)switch(obj=e.data,obj.result){case"new":loginProcess();break;case"not_deleted":loginProcess();break;case"deleted":alert("迷惑行為と見なされたため、只今ご利用できません。\n再度、利用されたい場合はお問い合わせください。");break;case"error":alert("通信に失敗しました")}else Ti.UI.createAlertDialog({title:"通信に失敗しました"}).show()})}else if("update"==obj.version){var r=Ti.UI.createAlertDialog({message:"アプリを最新版にアップデートしてください",buttonNames:["アップデート"]});r.addEventListener("click",function(e){0==e.index&&Ti.Platform.openURL(obj.update_url)}),r.show()}else switch(obj.result){case"new":loginProcess();break;case"not_deleted":loginProcess();break;case"deleted":alert("迷惑行為と見なされたため、只今ご利用できません。\n再度、利用されたい場合はお問い合わせください。");break;case"error":alert("通信に失敗しました")}else Ti.UI.createAlertDialog({title:"通信に失敗しました"}).show()})}function loginProcess(){Ti.App.Properties.setString("uuid",obj.uuid),Ti.App.Properties.setString("uid",obj.id),null==Ti.App.Properties.getString("desc")&&Ti.App.Properties.setString("desc",""),createTabGroup()}function createTabGroup(){tabGroup=Titanium.UI.createTabGroup({top:20});var e=require("bbsWindow"),t=new e,i=Titanium.UI.createTab({icon:"KS_nav_views.png",title:"Tab 1",window:t});tabGroup.addTab(i),tabGroup.open()}function sendData(e,t,i){var r=e,a=t,n=Titanium.Network.createHTTPClient();n.timeout=1e4,n.open("POST",r),n.onload=function(){i({success:!0,data:JSON.parse(this.responseText)})},n.onerror=function(e){i({success:!1,data:e})},n.send(a)}function getData(e,t){var i=e,r=Titanium.Network.createHTTPClient();r.timeout=1e4,r.open("GET",i),r.onload=function(){Ti.API.info("パース前："+this.responseText),t({success:!0,data:JSON.parse(this.responseText)})},r.onerror=function(e){t({success:!1,data:e})},r.send()}Ti.App.domain="https://monstbbs.herokuapp.com/",Ti.API.info("######"+Ti.Platform.createUUID());var Admob=require("ti.admob"),nend=require("net.nend"),iOSUniqueID=require("com.joseandro.uniqueids"),displayWidth=Titanium.Platform.displayCaps.platformWidth,displayHeight=Titanium.Platform.displayCaps.platformHeight;Ti.API.info("Width: "+displayWidth+"\nHeight: "+displayHeight),Titanium.UI.setBackgroundColor("black");var recruitID="",luck_restriction="",tabGroup;checkLogin(),Ti.App.addEventListener("resume",function(){if(""!=recruitID||"0"==recruitID){if(1==luck_restriction||"t"==luck_restriction){rID=recruitID,recruitID="",luck_restriction="";var e=Titanium.UI.createAlertDialog({title:"迷惑行為撲滅のため\nアンケートに\nご協力ください",message:"先ほどのマルチ募集で運極（ラック極）は何人いましたか？",buttonNames:["全員運極だった","運極は3人","運極は2人","運極は1人","運極は誰もいなかった","わからない","マルチに入れなかった","アンケートに答えない"],cancel:7});e.addEventListener("click",function(e){var t={user_id:Ti.App.Properties.getString("uid"),recruit_id:rID,answer:e.index};url=Ti.App.domain+"send_answer.json",sendData(url,t,function(){})}),e.show()}if(null==Ti.App.Properties.getString("review"))recruitID="",Ti.App.Properties.setString("review","false"),Ti.App.Properties.setString("resume_count",0);else if("false"==Ti.App.Properties.getString("review"))if(recruitID="",parseInt(Ti.App.Properties.getString("resume_count"))<1)Ti.App.Properties.setString("resume_count",parseInt(Ti.App.Properties.getString("resume_count"))+1);else{Ti.App.Properties.setString("resume_count",0);var t=Titanium.UI.createAlertDialog({title:"ご利用ありがとうございます",message:"\n応援レビューを書いて、本アプリを応援して頂けないでしょうか？\n\n皆様から応援を頂けると開発が頑張れます!\n\nまた何かご要望があればレビューに書いて頂ければ修正します！",buttonNames:["キャンセル","応援する"],cancel:0});t.addEventListener("click",function(e){1==e.index&&(Ti.Platform.openURL("http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?id=955313441&pageNumber=0&sortOrdering=1&type=Purple+Software&mt=8"),Ti.App.Properties.setString("review","true"))}),t.show()}}});